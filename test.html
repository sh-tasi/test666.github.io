<!DOCTYPE html>
<html>
<head>
    <title> TgTest </title>

</head>
<body>
<script>
    // 解析 query string
    const urlParams = new URLSearchParams(window.location.search);
    const authUrl = urlParams.get('authUrl'); // 假設 query string 為 ?authUrl=https://new-url.com
    console.log(authUrl);
    if (authUrl) {
        // 創建新的 script 元素
        const script = document.createElement('script');
        script.src = 'https://telegram.org/js/telegram-widget.js?22';
        script.async = true;
        script.setAttribute('data-telegram-login', 'StackCore_Sport_bot');
        script.setAttribute('data-size', 'big');
        script.setAttribute('data-userpic', 'false');
        script.setAttribute('data-radius', '14');
        script.setAttribute('data-auth-url', authUrl);
        script.setAttribute('data-request-access', 'write');

        // 將 script 添加到頁面
        document.body.appendChild(script);
    }
    else {
        // 創建新的 script 元素
        const script = document.createElement('script');
        script.src = 'https://telegram.org/js/telegram-widget.js?22';
        script.async = true;
        script.setAttribute('data-telegram-login', 'PlatfromTestTg_Bot');
        script.setAttribute('data-size', 'big');
        script.setAttribute('data-userpic', 'false');
        script.setAttribute('data-radius', '14');
        script.setAttribute('data-auth-url', "");
        script.setAttribute('data-request-access', 'write');

        // 將 script 添加到頁面
        document.body.appendChild(script);
    }
</script>
<script type="text/javascript">
  function onTelegramAuth(user) {
    alert('Logged in as ' + user.first_name + ' ' + user.last_name + ' (' + user.id + (user.username ? ', @' + user.username : '') + ')');
    let getUrlString = location.href;
    window.parent.postMessage(user, getUrlString);
  }
</script>

</body>
</html>
